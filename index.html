<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Offline AI Chatbot</title>

<style>
body {
  margin: 0;
  font-family: system-ui, sans-serif;
  background: #0f172a;
  color: #e5e7eb;
  display: flex;
  flex-direction: column;
  height: 100vh;
}

header {
  padding: 12px;
  text-align: center;
  background: #020617;
  font-weight: bold;
}

#chat {
  flex: 1;
  padding: 12px;
  overflow-y: auto;
}

.msg {
  margin-bottom: 10px;
  padding: 10px;
  border-radius: 10px;
  max-width: 85%;
}

.user {
  background: #2563eb;
  margin-left: auto;
}

.bot {
  background: #1e293b;
}

footer {
  display: flex;
  padding: 10px;
  gap: 8px;
  background: #020617;
}

input {
  flex: 1;
  padding: 10px;
  border-radius: 8px;
  border: none;
}

button {
  padding: 10px 16px;
  border-radius: 8px;
  border: none;
  background: #22c55e;
  font-weight: bold;
}
</style>
</head>

<body>

<header>ðŸ§  Offline AI Chatbot</header>

<div id="chat"></div>

<footer>
  <input id="input" placeholder="Type your message..." />
  <button onclick="send()">Send</button>
</footer>

<script type="module">
import { pipeline } from "https://cdn.jsdelivr.net/npm/@xenova/transformers@2.6.0";

const chat = document.getElementById("chat");
const input = document.getElementById("input");

function addMsg(text, cls) {
  const div = document.createElement("div");
  div.className = "msg " + cls;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

addMsg("Loading AI modelâ€¦ (first time may take ~30â€“60s)", "bot");

const generator = await pipeline(
  "text-generation",
  "Xenova/tiny-gpt2",
  { quantized: true }
);

addMsg("AI ready. Ask me anything.", "bot");

async function send() {
  if (!input.value.trim()) return;

  const userText = input.value;
  input.value = "";

  addMsg(userText, "user");

  const prompt = `User: ${userText}\nAI:`;

  const output = await generator(prompt, {
    max_new_tokens: 60,
    temperature: 0.7,
    top_p: 0.9
  });

  let reply = output[0].generated_text.replace(prompt, "").trim();
  addMsg(reply || "â€¦", "bot");
}

input.addEventListener("keydown", e => {
  if (e.key === "Enter") send();
});
</script>

</body>
</html>
